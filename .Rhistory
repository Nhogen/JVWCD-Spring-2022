knitr::opts_chunk$set(echo = TRUE)
list.of.packages <- c("tidyverse", "lubridate","chron","knitr")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(tidyverse)
library(lubridate)
library(chron)
library(knitr)
#read in data. Change names to be more readable and make hourly demand numeric
sd <- read.csv("2_year_system_demand.csv")%>%
rename('hourly_demand' = 'Hourly.Demand..cfs.',
'date_time' = 'Read.Date.Time')%>%
mutate(hourly_demand = as.numeric(hourly_demand),
hourly_demand = ifelse(is.na(hourly_demand),0,hourly_demand)) #What do we do with NA's???
#Make Date and Time match a consistent format with the Weather Data
sd2 <- as.data.frame(str_split_fixed(sd$date_time, " ", 3))%>%
rename(date = V1, time = V2, am_or_pm = V3)%>%
mutate(datetime_str = paste(date, time, am_or_pm),
datetime = as.POSIXct(strptime(datetime_str, format = "%m/%d/%y %I:%M %p")),
datetime_military = strftime(datetime, format = "%m/%d/%Y %H:%M")) %>%
select(datetime,datetime_military)
sd3 <-as.data.frame(str_split_fixed(sd2$datetime_military, " ", 2))%>%
rename(date = V1, time = V2)
sd4 <-as.data.frame(str_split_fixed(sd3$date, "/", 3))%>%
rename(CalendarMonth = V1,  CalendarDay = V2, CalendarYear = V3)
#Throw it all together
sd <- cbind(sd,sd2,sd3,sd4)%>%
select(-date_time)
#Get rid of temp dfs
remove(sd2,sd3,sd4)
#The names and dates in this table do not need much conversion
wa <- read.csv("weather_sl_airport.csv")
sp <- read.csv("system_demand_by_point_type.csv")%>%
rename('date_time' = 'Read.Date.Time',
'well_flow_cfs' = 'Well.Flow..cfs.',
'purchased_flow_cfs' = 'Purchased.Flow..cfs.',
'transported_flow_cfs' = 'Transported.Flow..cfs.',
'treated_flow_cfs' = 'Treated.Flow..cfs.',
'injected_flow_cfs' = 'Injected.Flow..cfs.',
'reservoir_trend_cfs' = 'Reservoir.Trend..cfs.',)
#Make Date and Time match a consistant format with the Weather Data
sp2 <- as.data.frame(str_split_fixed(sp$date_time, " ", 3))%>%
rename(date = V1, time = V2, am_or_pm = V3)%>%
mutate(datetime_str = paste(date, time, am_or_pm),
datetime = as.POSIXct(strptime(datetime_str, format = "%m/%d/%y %I:%M %p")),
datetime_military = strftime(datetime, format = "%m/%d/%Y %H:%M")) %>%
select(datetime,datetime_military)
sp3 <-as.data.frame(str_split_fixed(sp2$datetime_military, " ", 2))%>%
rename(date = V1, time = V2)
sp4 <-as.data.frame(str_split_fixed(sp3$date, "/", 3))%>%
rename(CalendarMonth = V1,  CalendarDay = V2, CalendarYear = V3)
#Throw it all together
sp <- cbind(sp,sp2,sp3,sp4)%>%
select(-date_time)
#Get rid of temp dfs
remove(sp2,sp3,sp4)
glimpse(sd)
summary(sd)
glimpse(sp)
summary(sp)
glimpse(wa)
summary(wa)
