"0","# have to create a time series demand object"
"0","y <- ts(train$avg_demand_mgd, frequency = 365)"
"0",""
"0","# remove avg_demand_mgd from train data"
"0","train2 <- train %>% "
"0","  select(-avg_demand_mgd)"
"0",""
"0","summary(train2)"
"1",""
"1","      date           "
"1","  CalendarYear "
"1"," CalendarMonth   "
"1","  CalendarDay   "
"1"," TemperatureMax  "
"1","
"
"1"," Min.   :2020-01-01  "
"1"," Min.   :2020  "
"1"," Min.   : 1.000  "
"1"," Min.   : 1.00  "
"1"," Min.   : 24.26  "
"1","
"
"1"," 1st Qu.:2020-07-16  "
"1"," 1st Qu.:2020  "
"1"," 1st Qu.: 3.000  "
"1"," 1st Qu.: 8.00  "
"1"," 1st Qu.: 46.04  "
"1","
"
"1"," Median :2021-02-09  "
"1"," Median :2021  "
"1"," Median : 6.000  "
"1"," Median :15.00  "
"1"," Median : 62.96  "
"1","
"
"1"," Mean   :2021-02-13  "
"1"," Mean   :2021  "
"1"," Mean   : 6.029  "
"1"," Mean   :15.45  "
"1"," Mean   : 64.57  "
"1","
"
"1"," 3rd Qu.:2021-09-16  "
"1"," 3rd Qu.:2021  "
"1"," 3rd Qu.: 9.000  "
"1"," 3rd Qu.:23.00  "
"1"," 3rd Qu.: 84.02  "
"1","
"
"1"," Max.   :2022-04-04  "
"1"," Max.   :2022  "
"1"," Max.   :12.000  "
"1"," Max.   :31.00  "
"1"," Max.   :107.06  "
"1","
"
"1",""
"1"," TemperatureMin "
"1"," CoolingDegreeDays"
"1","    SnowFall     "
"1"," RainDays"
"1","    season   "
"1"," RainWeek"
"1","  TempMean4Day  "
"1","
"
"1"," Min.   : 9.14  "
"1"," Min.   : 0.000   "
"1"," Min.   :0.0000  "
"1"," 0:566   "
"1"," Fall  :146  "
"1"," 1:538   "
"1"," Min.   :26.95  "
"1","
"
"1"," 1st Qu.:29.12  "
"1"," 1st Qu.: 0.000   "
"1"," 1st Qu.:0.0000  "
"1"," 1: 91   "
"1"," Spring:177  "
"1"," 0:119   "
"1"," 1st Qu.:37.84  "
"1","
"
"1"," Median :41.00  "
"1"," Median : 0.000   "
"1"," Median :0.0000  "
"1","         "
"1"," Summer:146  "
"1","         "
"1"," Median :50.33  "
"1","
"
"1"," Mean   :43.20  "
"1"," Mean   : 3.935   "
"1"," Mean   :0.1047  "
"1","         "
"1"," Winter:188  "
"1","         "
"1"," Mean   :54.01  "
"1","
"
"1"," 3rd Qu.:55.94  "
"1"," 3rd Qu.: 5.970   "
"1"," 3rd Qu.:0.0000  "
"1","         "
"1","             "
"1","         "
"1"," 3rd Qu.:69.19  "
"1","
"
"1"," Max.   :82.04  "
"1"," Max.   :28.020   "
"1"," Max.   :4.4800  "
"1","         "
"1","             "
"1","         "
"1"," Max.   :88.07  "
"1","
"
"1",""
"1","   Precip4Day     "
"1"," SnowDepth4Day   "
"1","
"
"1"," Min.   :0.00000  "
"1"," Min.   :0.0000  "
"1","
"
"1"," 1st Qu.:0.00000  "
"1"," 1st Qu.:0.0000  "
"1","
"
"1"," Median :0.01000  "
"1"," Median :0.0000  "
"1","
"
"1"," Mean   :0.02956  "
"1"," Mean   :0.2277  "
"1","
"
"1"," 3rd Qu.:0.04444  "
"1"," 3rd Qu.:0.0000  "
"1","
"
"1"," Max.   :0.25000  "
"1"," Max.   :4.5856  "
"1","
"
"0","# generate ts model"
"0","tslm_mod <- tslm(y ~., data = train2)"
"0","summary(tslm_mod)"
"1","
Call:
"
"1",""
"1","tslm(formula = y ~ ., data = train2)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-56.202 "
"1","-10.068 "
"1"," -0.619 "
"1"," 10.759 "
"1"," 44.644 "
"1","
"
"1","
Coefficients:
"
"1","                 "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)      "
"1","  2.685e+06"
"1","  1.474e+06"
"1","   1.822"
"1"," 0.068928"
"1"," .  "
"1","
date             "
"1","  2.986e+00"
"1","  2.086e+00"
"1","   1.431"
"1"," 0.152805"
"1","    "
"1","
CalendarYear     "
"1"," -1.356e+03"
"1","  7.484e+02"
"1","  -1.812"
"1"," 0.070412"
"1"," .  "
"1","
CalendarMonth    "
"1"," -1.127e+02"
"1","  6.228e+01"
"1","  -1.809"
"1"," 0.070883"
"1"," .  "
"1","
CalendarDay      "
"1"," -3.474e+00"
"1","  2.047e+00"
"1","  -1.696"
"1"," 0.090283"
"1"," .  "
"1","
TemperatureMax   "
"1","  3.590e-01"
"1","  1.223e-01"
"1","   2.935"
"1"," 0.003456"
"1"," ** "
"1","
TemperatureMin   "
"1"," -2.235e-01"
"1","  1.717e-01"
"1","  -1.302"
"1"," 0.193505"
"1","    "
"1","
CoolingDegreeDays"
"1","  7.940e-01"
"1","  2.205e-01"
"1","   3.601"
"1"," 0.000341"
"1"," ***"
"1","
SnowFall         "
"1"," -3.163e-01"
"1","  1.633e+00"
"1","  -0.194"
"1"," 0.846495"
"1","    "
"1","
RainDays1        "
"1"," -7.028e-01"
"1","  2.297e+00"
"1","  -0.306"
"1"," 0.759708"
"1","    "
"1","
seasonSpring     "
"1","  5.336e+00"
"1","  3.714e+00"
"1","   1.437"
"1"," 0.151241"
"1","    "
"1","
seasonSummer     "
"1"," -6.798e-01"
"1","  3.360e+00"
"1","  -0.202"
"1"," 0.839742"
"1","    "
"1","
seasonWinter     "
"1","  2.514e+01"
"1","  3.137e+00"
"1","   8.013"
"1"," 5.33e-15"
"1"," ***"
"1","
RainWeek0        "
"1","  6.465e+00"
"1","  1.825e+00"
"1","   3.543"
"1"," 0.000424"
"1"," ***"
"1","
TempMean4Day     "
"1","  2.795e+00"
"1","  1.416e-01"
"1","  19.730"
"1","  < 2e-16"
"1"," ***"
"1","
Precip4Day       "
"1"," -6.939e+01"
"1","  1.831e+01"
"1","  -3.789"
"1"," 0.000165"
"1"," ***"
"1","
SnowDepth4Day    "
"1","  9.159e+00"
"1","  1.306e+00"
"1","   7.016"
"1"," 5.84e-12"
"1"," ***"
"1","
trend            "
"1","  9.058e-01"
"1","  1.798e-01"
"1","   5.038"
"1"," 6.12e-07"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","16.11"
"1"," "
"1","on"
"1"," "
"1","639"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.909"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.9066"
"1"," "
"1","
F-statistic:"
"1"," "
"1","375.4"
"1"," "
"1","on"
"1"," "
"1","17"
"1"," "
"1","and"
"1"," "
"1","639"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","fit <- fitted(tslm_mod)"
"0","#graph showing actuals vs fitted"
"0","autoplot(y) + autolayer(fit)"
