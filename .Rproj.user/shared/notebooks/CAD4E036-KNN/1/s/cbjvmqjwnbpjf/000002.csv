"0","wa <- read.csv(""new_weather_slc_airport.csv"")%>%"
"0","  mutate(season = ifelse(CalendarMonth %in% c('3','4','5'), 'Spring',"
"0","                         ifelse(CalendarMonth %in% c('6','7','8'), 'Summer',"
"0","                                ifelse(CalendarMonth %in% c('9','10','11'), 'Fall',"
"0","                                       ifelse(CalendarMonth %in% c('12','1','2'), 'Winter','0')))),"
"0","         #RainDays = factor(RainDays),"
"0","         date = as.Date(WeatherDate,format=""%m/%d/%Y""),"
"0","         RainDays = ifelse(Precipitation < 0.05, 0 , RainDays),"
"0","         Precipitation = ifelse(Precipitation < 0.05, 0 , Precipitation))%>%"
"0","  filter(CalendarYear>=2020)"
"0",""
"0",""
"0","sd <- read.csv(""new_daily_demand.csv"")%>%"
"0","  rename('avg_demand_cfs' = 'Avg.Daily.Demand..cfs.',"
"0","         'avg_demand_af' = 'Avg.Daily.Demand..af.',"
"0","         'avg_demand_mgd' = 'Avg.Daily.Demand..mgd.',"
"0","         'max_demand_cfs' = 'Max.Daily.Demand..cfs.',"
"0","         'max_demand_af' = 'Max.Daily.Demand..af.',"
"0","         'max_demand_mgd' = 'Max.Daily.Demand..mgd.',"
"0","         'min_demand_cfs' = 'Min.Daily.Demand..cfs.',"
"0","         'min_demand_af' = 'Min.Daily.Demand..af.',"
"0","         'min_demand_mgd' = 'Min.Daily.Demand..mgd.')%>%#Clifton said this is a min"
"0","  mutate(date = as.Date(ReadDate,format=""%m/%d/%Y""))"
"0",""
"0",""
"0","wd <- merge(wa,sd,by=""date"")"
"0",""
"0",""
"0","mgd_avg <- wd%>%"
"0","  select(-avg_demand_cfs,"
"0","         -avg_demand_af,"
"0","         #-avg_demand_mgd, ## Target Variable"
"0","         -max_demand_cfs,"
"0","         -max_demand_af,"
"0","         -max_demand_mgd,"
"0","         -min_demand_cfs,"
"0","         -min_demand_af,"
"0","         -min_demand_mgd)%>%"
"0","  select(-WeatherDate,-ReadDate)"
"0",""
"0",""
"0","rainwk <- mgd_avg%>%"
"0","  mutate(Week_no = format(date, ""%U""))%>%"
"0","  group_by(Week_no)%>%"
"0","  summarize(RainWeek = as.factor(ifelse(sum(RainDays)>0,1,0)))"
"0",""
"0","mgd_avg <- mgd_avg %>%"
"0","  mutate(Week_no = as.factor(format(date, ""%U"")),"
"0","         RainDays = as.factor(RainDays),"
"0","         season = as.factor(season))"
"0",""
"0","mgd_avg <- dplyr::left_join(mgd_avg,rainwk,by=""Week_no"")"
"0",""
"0","mgd_avg <- mgd_avg%>% select(-Week_no)"
"0",""
"0","# Rollmean 9 Day Average Calculations"
"0","Avg4 <- mgd_avg %>% "
"0","  mutate(TempMean4Day = rollmean(TemperatureMean, k = 9, fill = mean(TemperatureMean)),"
"0","         Precip4Day = rollmean(Precipitation, k = 9, fill = mean(Precipitation)),"
"0","         SnowDepth4Day = rollmean(SnowDepth, k = 9, fill = mean(SnowDepth)))%>% "
"0","  select(-Precipitation, -TemperatureMean, -SnowDepth)"
