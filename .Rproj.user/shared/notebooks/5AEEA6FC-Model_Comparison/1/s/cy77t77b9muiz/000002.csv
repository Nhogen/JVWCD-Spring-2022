"0","df <- Avg4_W"
"0","target <- 11"
"0","seedVal <- 6496"
"0","metrics_list = c(""R2"",""MAE"",""MAPE"",""RMSE"")"
"0","nFolds = 3"
"0",""
"0","cv_function <- function(df, target, nFolds, seedVal, metrics_list)"
"0","{"
"0","# create folds using the assigned values"
"0",""
"0","set.seed(seedVal)"
"0","folds = createFolds(df[,target],nFolds)"
"0",""
"0","# The lapply loop"
"0",""
"0","cv_results <- lapply(folds, function(x)"
"0","{ "
"0","# data preparation:"
"0",""
"0","  test_target <- df[x,target]"
"0","  test_input <- df[x,-target]"
"0","  "
"0","  train_target <- df[-x,target]"
"0","  train_input <- df[-x,-target]"
"0",""
"0","  "
"0","   model <- mod3 "
"0","  pred <- predict(model, test_input)"
"0","  return(mmetric(test_target,pred,metrics_list))"
"0","})"
"0",""
"0","cv_results_m <- as.matrix(as.data.frame(cv_results))"
"0","cv_mean<- as.matrix(rowMeans(cv_results_m))"
"0","cv_sd <- as.matrix(rowSds(cv_results_m))"
"0","colnames(cv_mean) <- ""Mean"""
"0","colnames(cv_sd) <- ""Sd"""
"0","cv_all <- cbind(cv_results_m, cv_mean, cv_sd)"
"0","kable(t(cv_all),digits=2)"
"0","}"
