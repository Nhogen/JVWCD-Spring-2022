"0","#View Model"
"0","mod3 <- lm(avg_demand_mgd ~., data=mgd_avg)"
"0","summary(mod3)"
"1","
Call:
"
"1",""
"1","lm(formula = avg_demand_mgd ~ ., data = mgd_avg)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-44.294 "
"1","-11.702 "
"1"," -1.286 "
"1"," 10.963 "
"1"," 61.203 "
"1","
"
"1","
Coefficients: ("
"1",""
"1","2"
"1",""
"1"," not defined because of singularities)
"
"1","                 "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)      "
"1"," -4.166e+04"
"1","  2.924e+04"
"1","  -1.425"
"1"," 0.155153"
"1","    "
"1","
date             "
"1","  2.239e+00"
"1","  1.572e+00"
"1","   1.424"
"1"," 0.155304"
"1","    "
"1","
CalendarYear     "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
CalendarMonth    "
"1"," -6.444e+01"
"1","  4.802e+01"
"1","  -1.342"
"1"," 0.180452"
"1","    "
"1","
CalendarDay      "
"1"," -2.001e+00"
"1","  1.566e+00"
"1","  -1.277"
"1"," 0.202286"
"1","    "
"1","
TemperatureMax   "
"1","  5.879e-01"
"1","  1.734e-01"
"1","   3.391"
"1"," 0.000777"
"1"," ***"
"1","
TemperatureMin   "
"1","  1.160e+00"
"1","  2.301e-01"
"1","   5.042"
"1"," 7.43e-07"
"1"," ***"
"1","
TemperatureMean  "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
Precipitation    "
"1"," -1.532e+01"
"1","  9.011e+00"
"1","  -1.700"
"1"," 0.089945"
"1"," .  "
"1","
CoolingDegreeDays"
"1","  7.275e-01"
"1","  2.649e-01"
"1","   2.746"
"1"," 0.006343"
"1"," ** "
"1","
SnowDepth        "
"1","  4.874e+00"
"1","  1.262e+00"
"1","   3.861"
"1"," 0.000135"
"1"," ***"
"1","
SnowFall         "
"1"," -7.693e-01"
"1","  1.413e+00"
"1","  -0.544"
"1"," 0.586600"
"1","    "
"1","
RainDays1        "
"1"," -7.122e-01"
"1","  2.862e+00"
"1","  -0.249"
"1"," 0.803630"
"1","    "
"1","
seasonFall       "
"1"," -3.879e+01"
"1","  5.271e+00"
"1","  -7.359"
"1"," 1.35e-12"
"1"," ***"
"1","
seasonWinter     "
"1"," -3.827e+01"
"1","  8.012e+00"
"1","  -4.777"
"1"," 2.63e-06"
"1"," ***"
"1","
Prev3Day         "
"1"," -6.788e+01"
"1","  1.187e+01"
"1","  -5.717"
"1"," 2.34e-08"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","16.79"
"1"," "
"1","on"
"1"," "
"1","347"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8837"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8793"
"1"," "
"1","
F-statistic:"
"1"," "
"1","202.8"
"1"," "
"1","on"
"1"," "
"1","13"
"1"," "
"1","and"
"1"," "
"1","347"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","#Change everything to Prevday"
"0","PrevDayAll = shift.column(mgd_avg,columns =c('TemperatureMean',"
"0","                                             'TemperatureMax',"
"0","                                             'TemperatureMin',"
"0","                                             'Precipitation',"
"0","                                             'CoolingDegreeDays',"
"0","                                             'SnowDepth',"
"0","                                             'SnowFall',"
"0","                                             'RainDays'),len = 1L,up=TRUE)"
"0",""
"0","#Remove unshifted columns"
"0","PrevDayAll = PrevDayAll %>% "
"0","  select(-one_of('TemperatureMean',"
"0","                 'TemperatureMax',"
"0","                 'TemperatureMin',"
"0","                 'Precipitation',"
"0","                 'CoolingDegreeDays',"
"0","                 'SnowDepth',"
"0","                 'SnowFall',"
"0","                 'RainDays'))"
"0",""
"0","#Rename Columns"
"0","PrevDayAll = PrevDayAll %>% "
"0","  rename(PrevDayMeanTemp = TemperatureMean.Shifted,"
"0","         PrevDayMaxTemp = TemperatureMax.Shifted,"
"0","         PrevDayMinTemp = TemperatureMin.Shifted,"
"0","         PrevDayRain = Precipitation.Shifted,"
"0","         PrevDayCoolingDegDays = CoolingDegreeDays.Shifted,"
"0","         PrevDaySnowDepth = SnowDepth.Shifted,"
"0","         PrevDaySnowFall = SnowFall.Shifted,"
"0","         PrevDayRainDay = RainDays.Shifted,)"
"0",""
"0","#run model again now"
"0","modprev3 <- lm(avg_demand_mgd ~., data=PrevDayAll)"
"0","summary(modprev3)"
"1","
Call:
"
"1",""
"1","lm(formula = avg_demand_mgd ~ ., data = PrevDayAll)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-51.311 "
"1","-10.520 "
"1"," -1.873 "
"1"," 10.740 "
"1"," 58.230 "
"1","
"
"1","
Coefficients: ("
"1",""
"1","2"
"1",""
"1"," not defined because of singularities)
"
"1","                     "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)          "
"1"," -4.708e+04"
"1","  3.052e+04"
"1","  -1.542"
"1","   0.1239"
"1","    "
"1","
date                 "
"1","  2.530e+00"
"1","  1.641e+00"
"1","   1.542"
"1","   0.1240"
"1","    "
"1","
CalendarYear         "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
CalendarMonth        "
"1"," -7.286e+01"
"1","  5.012e+01"
"1","  -1.454"
"1","   0.1469"
"1","    "
"1","
CalendarDay          "
"1"," -2.282e+00"
"1","  1.635e+00"
"1","  -1.396"
"1","   0.1637"
"1","    "
"1","
seasonFall           "
"1"," -4.136e+01"
"1","  5.470e+00"
"1","  -7.562"
"1"," 3.61e-13"
"1"," ***"
"1","
seasonWinter         "
"1"," -4.065e+01"
"1","  8.313e+00"
"1","  -4.889"
"1"," 1.55e-06"
"1"," ***"
"1","
Prev3Day             "
"1"," -8.937e+01"
"1","  1.201e+01"
"1","  -7.442"
"1"," 7.92e-13"
"1"," ***"
"1","
PrevDayMeanTemp      "
"1","  2.555e+00"
"1","  4.769e-01"
"1","   5.357"
"1"," 1.54e-07"
"1"," ***"
"1","
PrevDayMaxTemp       "
"1"," -7.696e-01"
"1","  3.840e-01"
"1","  -2.004"
"1","   0.0458"
"1"," *  "
"1","
PrevDayMinTemp       "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
PrevDayRain          "
"1"," -8.018e+00"
"1","  9.361e+00"
"1","  -0.857"
"1","   0.3923"
"1","    "
"1","
PrevDayCoolingDegDays"
"1","  5.688e-01"
"1","  2.779e-01"
"1","   2.047"
"1","   0.0415"
"1"," *  "
"1","
PrevDaySnowDepth     "
"1","  4.205e+00"
"1","  1.306e+00"
"1","   3.220"
"1","   0.0014"
"1"," ** "
"1","
PrevDaySnowFall      "
"1"," -5.052e-01"
"1","  1.466e+00"
"1","  -0.344"
"1","   0.7307"
"1","    "
"1","
PrevDayRainDay1      "
"1","  2.032e+00"
"1","  2.968e+00"
"1","   0.684"
"1","   0.4941"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","17.44"
"1"," "
"1","on"
"1"," "
"1","346"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8744"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8697"
"1"," "
"1","
F-statistic:"
"1"," "
"1","185.4"
"1"," "
"1","on"
"1"," "
"1","13"
"1"," "
"1","and"
"1"," "
"1","346"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","#R2 is worse now?"
"0",""
"0","#I guess let's try a 3 day average of everything?"
"0",""
