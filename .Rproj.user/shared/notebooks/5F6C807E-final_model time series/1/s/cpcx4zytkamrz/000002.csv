"0","# gather 2020 data"
"0","data2020 <- Avg3 %>% "
"0","  filter(CalendarYear==2020) %>% "
"0","  select(-date,"
"0","         -CalendarYear,"
"0","         -CalendarMonth,"
"0","         -CalendarDay)%>%"
"0","  mutate(season = as.factor(season))"
"0","summary(data2020)"
"1",""
"1"," TemperatureMax  "
"1"," TemperatureMin "
"1"," CoolingDegreeDays"
"1","    SnowFall     "
"1"," RainDays"
"1","
"
"1"," Min.   : 26.24  "
"1"," Min.   : 9.14  "
"1"," Min.   : 0.000   "
"1"," Min.   :0.0000  "
"1"," 0:315   "
"1","
"
"1"," 1st Qu.: 46.04  "
"1"," 1st Qu.:30.20  "
"1"," 1st Qu.: 0.000   "
"1"," 1st Qu.:0.0000  "
"1"," 1: 50   "
"1","
"
"1"," Median : 66.02  "
"1"," Median :44.06  "
"1"," Median : 0.000   "
"1"," Median :0.0000  "
"1","         "
"1","
"
"1"," Mean   : 66.54  "
"1"," Mean   :44.71  "
"1"," Mean   : 4.385   "
"1"," Mean   :0.1048  "
"1","         "
"1","
"
"1"," 3rd Qu.: 87.08  "
"1"," 3rd Qu.:59.00  "
"1"," 3rd Qu.: 8.490   "
"1"," 3rd Qu.:0.0000  "
"1","         "
"1","
"
"1"," Max.   :105.08  "
"1"," Max.   :78.08  "
"1"," Max.   :24.510   "
"1"," Max.   :8.5800  "
"1","         "
"1","
"
"1",""
"1","    season  "
"1"," avg_demand_mgd  "
"1"," RainWeek"
"1","   Precip3Day     "
"1","  Tempmean3Day   "
"1","
"
"1"," Fall  :91  "
"1"," Min.   : 39.87  "
"1"," 1:289   "
"1"," Min.   :0.00000  "
"1"," Min.   : 33.53  "
"1","
"
"1"," Spring:92  "
"1"," 1st Qu.: 49.12  "
"1"," 0: 76   "
"1"," 1st Qu.:0.00000  "
"1"," 1st Qu.: 65.58  "
"1","
"
"1"," Summer:91  "
"1"," Median : 75.72  "
"1","         "
"1"," Median :0.00000  "
"1"," Median : 97.15  "
"1","
"
"1"," Winter:91  "
"1"," Mean   :102.76  "
"1","         "
"1"," Mean   :0.03966  "
"1"," Mean   : 97.19  "
"1","
"
"1","            "
"1"," 3rd Qu.:156.20  "
"1","         "
"1"," 3rd Qu.:0.04500  "
"1"," 3rd Qu.:126.42  "
"1","
"
"1","            "
"1"," Max.   :209.59  "
"1","         "
"1"," Max.   :0.60750  "
"1"," Max.   :155.61  "
"1","
"
"0","#2020 model"
"0","mod2020 <- lm(avg_demand_mgd~., data = data2020)"
"0","summary(mod2020)"
"1","
Call:
"
"1",""
"1","lm(formula = avg_demand_mgd ~ ., data = data2020)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-45.307 "
"1","-11.509 "
"1"," -0.849 "
"1"," 10.641 "
"1"," 44.720 "
"1","
"
"1","
Coefficients:
"
"1","                 "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)      "
"1"," -94.04178"
"1","    7.26210"
"1"," -12.950"
"1","  < 2e-16"
"1"," ***"
"1","
TemperatureMax   "
"1","   0.97271"
"1","    0.16502"
"1","   5.894"
"1"," 8.79e-09"
"1"," ***"
"1","
TemperatureMin   "
"1","   0.32325"
"1","    0.22570"
"1","   1.432"
"1"," 0.152968"
"1","    "
"1","
CoolingDegreeDays"
"1","   1.05800"
"1","    0.27143"
"1","   3.898"
"1"," 0.000116"
"1"," ***"
"1","
SnowFall         "
"1","   1.41106"
"1","    1.62773"
"1","   0.867"
"1"," 0.386593"
"1","    "
"1","
RainDays1        "
"1","  -0.16218"
"1","    3.00083"
"1","  -0.054"
"1"," 0.956930"
"1","    "
"1","
seasonSpring     "
"1","   4.52201"
"1","    2.56816"
"1","   1.761"
"1"," 0.079138"
"1"," .  "
"1","
seasonSummer     "
"1","   0.89707"
"1","    3.57812"
"1","   0.251"
"1"," 0.802184"
"1","    "
"1","
seasonWinter     "
"1","  32.34846"
"1","    3.59324"
"1","   9.003"
"1","  < 2e-16"
"1"," ***"
"1","
RainWeek0        "
"1","  12.94655"
"1","    2.24837"
"1","   5.758"
"1"," 1.85e-08"
"1"," ***"
"1","
Precip3Day       "
"1","  20.41665"
"1","   10.60890"
"1","   1.924"
"1"," 0.055098"
"1"," .  "
"1","
Tempmean3Day     "
"1","   1.02810"
"1","    0.06998"
"1","  14.692"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","16.18"
"1"," "
"1","on"
"1"," "
"1","353"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.9252"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.9229"
"1"," "
"1","
F-statistic:"
"1"," "
"1","397.1"
"1"," "
"1","on"
"1"," "
"1","11"
"1"," "
"1","and"
"1"," "
"1","353"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# gather 2021 data"
"0","data2021 <- Avg3 %>% "
"0","  filter(CalendarYear==2021) %>% "
"0","  select(-date,"
"0","         -CalendarYear,"
"0","         -CalendarMonth,"
"0","         -CalendarDay)%>%"
"0","  mutate(season = as.factor(season))"
"0","summary(data2021)"
"1",""
"1"," TemperatureMax  "
"1"," TemperatureMin "
"1"," CoolingDegreeDays"
"1","    SnowFall      "
"1"," RainDays"
"1","
"
"1"," Min.   : 26.24  "
"1"," Min.   :14.18  "
"1"," Min.   : 0.000   "
"1"," Min.   : 0.0000  "
"1"," 0:309   "
"1","
"
"1"," 1st Qu.: 48.92  "
"1"," 1st Qu.:31.10  "
"1"," 1st Qu.: 0.000   "
"1"," 1st Qu.: 0.0000  "
"1"," 1: 52   "
"1","
"
"1"," Median : 64.04  "
"1"," Median :42.08  "
"1"," Median : 0.000   "
"1"," Median : 0.0000  "
"1","         "
"1","
"
"1"," Mean   : 67.06  "
"1"," Mean   :45.54  "
"1"," Mean   : 4.772   "
"1"," Mean   : 0.1056  "
"1","         "
"1","
"
"1"," 3rd Qu.: 87.08  "
"1"," 3rd Qu.:60.98  "
"1"," 3rd Qu.: 8.490   "
"1"," 3rd Qu.: 0.0000  "
"1","         "
"1","
"
"1"," Max.   :107.06  "
"1"," Max.   :82.04  "
"1"," Max.   :28.020   "
"1"," Max.   :11.6900  "
"1","         "
"1","
"
"1",""
"1","    season  "
"1"," avg_demand_mgd  "
"1"," RainWeek"
"1","   Precip3Day     "
"1","  Tempmean3Day   "
"1","
"
"1"," Fall  :89  "
"1"," Min.   : 38.28  "
"1"," 1:284   "
"1"," Min.   :0.00000  "
"1"," Min.   : 45.24  "
"1","
"
"1"," Spring:92  "
"1"," 1st Qu.: 50.13  "
"1"," 0: 77   "
"1"," 1st Qu.:0.00000  "
"1"," 1st Qu.: 70.00  "
"1","
"
"1"," Summer:91  "
"1"," Median : 61.86  "
"1","         "
"1"," Median :0.00000  "
"1"," Median : 91.42  "
"1","
"
"1"," Winter:89  "
"1"," Mean   : 91.90  "
"1","         "
"1"," Mean   :0.06579  "
"1"," Mean   : 98.49  "
"1","
"
"1","            "
"1"," 3rd Qu.:141.35  "
"1","         "
"1"," 3rd Qu.:0.06250  "
"1"," 3rd Qu.:129.51  "
"1","
"
"1","            "
"1"," Max.   :182.77  "
"1","         "
"1"," Max.   :1.02000  "
"1"," Max.   :158.04  "
"1","
"
"0","# 2021 predictions"
"0",""
"0","pred <- predict(mod2020, data2021)"
"0",""
"0","# metrics"
"0","compare <- data.frame(actual = data2021$avg_demand_mgd,"
"0","                      predicted = pred)"
"0","compare"
